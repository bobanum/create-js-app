<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<script>
		var decalage = 13;
		var lettres = " abcdefghijklmnopqrstuvwxyz";
		document.addEventListener('DOMContentLoaded', () => {
			const form = document.querySelector('form');
			const clair = form.clair;
			const encrypte = form.encrypte;
			const decrypte = form.decrypte;
			clair.addEventListener('input', () => {
				var txt = clair.value;
				// Enlever les accents
				txt = txt.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
				// Mettre en minuscule
				txt = txt.toLowerCase();
				// Enlever les caractères spéciaux
				txt = txt.replace(/[^a-z ]/g, '');
				// Chiffrer
				encrypte.value = encrypter(txt);
				// Déchiffrer
				decrypte.value = decrypter(encrypte.value);
			});
		});
		function encrypter(txt) {
			var txtFinal = "";
			var p = 0;
			for (var i = 0; i < txt.length; i++) {
				var c = lettres.indexOf(txt.charAt(i));
				console.log(c, p);
				p = (c - p + decalage + lettres.length) % lettres.length;
				txtFinal += lettres.charAt(p);
			}
			return txtFinal;
		}
		function decrypter(txt) {
			var txtFinal = "";
			var p = 0;
			for (var i = 0; i < txt.length; i++) {
				var c = lettres.indexOf(txt.charAt(i));
				console.log(c, p);
				p = (c - p - decalage + lettres.length) % lettres.length;
				txtFinal += lettres.charAt(p);
			}
			return txtFinal;
		}
	</script>
	<style>
		form {
			display: flex;
			flex-direction: column;
			max-width: 90ch;
			margin: 0 auto;
		}
		fieldset {
			margin-bottom: 10px;
			display: flex;
		}
		textarea {
			width: 100%;
		}
		button {
			width: 100%;
		}
	</style>
</head>
<body>
	<form action="" onsubmit="return false;">
		<fieldset>
			<legend>Clair</legend>
			<textarea name="clair" id="clair" cols="60" rows="10"></textarea>
		</fieldset>
		<fieldset>
			<legend>Encrypté</legend>
			<textarea name="encrypte" id="encrypte" cols="60" rows="10"></textarea>
		</fieldset>
		<fieldset>
			<legend>Décrypté</legend>
			<textarea name="decrypte" id="decrypte" cols="60" rows="10"></textarea>
		</fieldset>
		<button type="submit">Encrypter</button>
	</form>
</body>
</html>